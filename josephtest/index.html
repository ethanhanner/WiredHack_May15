<!DOCTYPE html>
<html>
  <head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      ul {
	      list-style: none;
	      
      }
      .firstHeading {
	      margin-left: 10px;
      }
      #map-canvas{
	      position: relative;
	      top: 30px;
	      margin: 0 auto;
	      width: 50%;
	      height: 500px;
	      border: 1px solid rgba(0,0,0,0.2);
	      border-radius: 5px;
      }
    </style>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
    <script src="script.js"></script>
  </head>
<body>
	
	<div id="addressLocation"></div>
    <div id="map-canvas"></div>
	<div id="dom-target" style="display:none;">
	<?php
		$servername = "127.0.0.1";
		$username = "root";
		$password = "";
		
		$conn = new mysqli($servername, $username, $password);
		if($conn->connect_error) {
			die("Connection failed: " . $conn->connect_error);
		}
		$sql = "use Insignia;";
		if($conn->query($sql) === FALSE) {
			echo "Error selecting database: " . $conn->error;
			echo "<br/>";
			echo "\n";
		}
		
		$sql = "SELECT * FROM Dealership WHERE state = 'CO';";
		$result = $conn->query($sql);
		$index = 0;
		$records = array();
		if ($result->num_rows > 0) {
			foreach($result as $row) {
				$records[$index] = $row;
				$index += 1;
			}
		} else {
			echo "0 results";
		}
		
		header("Content-Type: application/json");
		
		echo json_encode($records);
	?>
	</div>
</body>
</html>